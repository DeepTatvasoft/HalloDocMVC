@model Services.ViewModels.SendOrders
<div class="main">
    <div class="back container mb-3 mt-3 d-flex justify-content-between">
        <h3 class="mt-2">
            Send Orders
        </h3>
        <a asp-controller="Admin" asp-action="AdminDashboard" style="text-decoration: none;" class="backimg">
            <img src="~/images/image_2024_01_17T04_17_17_757Z.png" alt="">
            <span>Back</span>
        </a>
    </div>
    <div class="container bg-white lightmode" style="padding-bottom:20px" id="maincontent">
        <form asp-controller="Admin" asp-action="OrderSubmit" method="post">
            <input asp-for="@Model.reqid" type="hidden">
            <input asp-for="@Model.createdby" type="hidden">
            <div class="pinfo mt-4">
                <div class="row row-cols-md-2 row-cols-sm-1 row-cols-1 mt-3">
                    <div class="col">
                        <select asp-for="professionid" class="form-select mb-3 profession" aria-label="Default select example" style="height:58px">
                            <option selected>Select Profession</option>
                        </select>
                    </div>
                    <div class="col">
                        <select asp-for="vendorid" class="form-select mb-3 business" aria-label="Default select example" style="height:58px">
                            <option selected>Business</option>
                        </select>
                    </div>
                    <div class="col">
                        <div class="form-floating mb-3">
                            <input asp-for="Contact" type="tel" class="form-control" id="floatingInput" name="contact" placeholder="Business Contact">
                            <label for="floatingInput">Business Contact</label>
                        </div>
                    </div>
                    <div class="col">
                        <div class="form-floating mb-3">
                            <input asp-for="Email" type="email" class="form-control" id="floatingInput" name="email" placeholder="Email">
                            <label for="floatingInput">Email</label>
                        </div>
                    </div>
                    <div class="col">
                        <div class="form-floating mb-3">
                            <input asp-for="Fax" type="text" class="form-control" id="floatingInput" name="fax" placeholder="Fax Number">
                            <label for="floatingInput">Fax Number</label>
                        </div>
                    </div>
                </div>
                <div class="form-floating mb-3">
                    <textarea asp-for="prescription" class="form-control" placeholder="Leave a comment here" id="floatingTextarea"
                              style="height: 100px;"></textarea>
                    <label for="floatingTextarea" class="medialabel">Prescription or Order datails</label>
                </div>
                <div class="form-floating">
                    <select asp-for="refil" class="form-select" id="floatingSelect" aria-label="Number Of Refil" style="width:538px;">
                        <option selected>Not Required</option>
                        <option value="1">One</option>
                        <option value="2">Two</option>
                        <option value="3">Three</option>
                    </select>
                    <label for="floatingSelect">Works with selects</label>
                </div>
            </div>
            <div class="submit mt-4">
                <button type="submit" class="btn btn-info" style="color: white;">Submit</button>
                <a asp-controller="Admin" asp-action="AdminDashboard">
                    <button type="button" class="btn btn-outline-info ms-2 viewnotes">Cancel</button>
                </a>
            </div>
        </form>
    </div>
</div>
<script>
    $(document).ready(function () {
        dark();
        var profession = $('.profession');
        $.ajax({
            url: '/Admin/getprofession',
            success: function (response) {
                response.forEach(function (item) {
                    //console.log(item);
                    profession.append(
                        $('<option>', {
                            value: item.healthprofessionalid,
                            text: item.professionname
                        }));
                    console.log("fetch success");
                });
                console.log("Fetch success");
            },
            error: function (xhr, status, error) {
                console.error(error);
            }
        });
        $('.profession').on('change', function (e) {
            var professionid = $(this).val();
            $.ajax({
                url: '/admin/filterprofession',
                data: { "professionid": professionid },
                success: function (response) {
                    $('input[name="contact"]').val("");
                    $('input[name="email"]').val("");
                    $('input[name="fax"]').val("");
                    //console.log(response);
                    var business = $('.business');
                    business.empty();
                    business.append(
                        $('<option>', {
                            value: "",
                            text: "Business"
                        }));
                    //console.log(physelect);
                    response.forEach(function (item) {
                        //console.log(item);
                        business.append(
                            $('<option>', {
                                value: item.vendorid,
                                text: item.vendorname
                            }));
                        console.log("fetch success");
                    });
                },
                error: function (xhr, status, error) {
                    console.error(error);
                }
            });
        });
        $('.business').on('change', function (e) {
            var vendorid = $(this).val();
            $.ajax({
                url: '/admin/filterbusiness',
                data: { "vendorid": vendorid },
                success: function (response) {
                    $('input[name="contact"]').val(response.businesscontact);
                    $('input[name="email"]').val(response.email);
                    $('input[name="fax"]').val(response.faxnumber);
                },
                error: function (xhr, status, error) {
                    console.error(error);
                }
            });
        });
    });
</script>